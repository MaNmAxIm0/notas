<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Notas do Ensino Secundário</title>
    <link rel="stylesheet" href="/notas/css/style.css">
    <script src="/notas/js/main.js" type="module"></script>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <h2>Login</h2>
        <form id="loginForm">
            <label for="loginEmail">Email:</label>
            <input type="email" id="loginEmail" required>
            <label for="loginPassword">Senha:</label>
            <input type="password" id="loginPassword" required>
            <button type="submit">Entrar</button>
            <button type="button" onclick="showRegister()">Criar Nova Conta</button>
        </form>
    </div>

    <!-- Register Screen -->
    <div id="registerScreen" class="register-screen" style="display: none;">
        <h2>Criar Nova Conta</h2>
        <form id="registerForm">
            <label for="registerEmail">Email:</label>
            <input type="email" id="registerEmail" required>
            <label for="registerPassword">Senha:</label>
            <input type="password" id="registerPassword" required>
            <button type="submit">Criar Conta</button>
            <button type="button" onclick="showLogin()">Voltar ao Login</button>
        </form>
    </div>

    <!-- Main Content -->
    <div id="mainContent" style="display: none;">
        <h1>Calculadora de Notas do Ensino Secundário</h1>
        <button onclick="logout()">Logout</button>

        <!-- Tabs -->
        <div class="tab-container">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="showTab('year10')">10º Ano</button>
                <button class="tab-button" onclick="showTab('year11')">11º Ano</button>
                <button class="tab-button" onclick="showTab('year12')">12º Ano</button>
                <button class="tab-button" onclick="showTab('exams')">Exames</button>
                <button class="tab-button" onclick="showTab('results')">Resultados</button>
            </div>
        </div>

        <!-- Year 10 Tab -->
        <div id="year10-tab" class="tab-content">
            <h2>10º Ano</h2>
            <div id="year10"></div>
        </div>

        <!-- Year 11 Tab -->
        <div id="year11-tab" class="tab-content" style="display: none;">
            <h2>11º Ano</h2>
            <div id="year11"></div>
        </div>

        <!-- Year 12 Tab -->
        <div id="year12-tab" class="tab-content" style="display: none;">
            <h2>12º Ano</h2>
            <div class="test-input-section">
                <select id="select12Subject"></select>
                <input type="text" id="testName" placeholder="Nome do Teste">
                <input type="number" id="testGrade" placeholder="Nota (0-20)">
                <select id="testDomain"></select>
                <button onclick="addTest12thYear()">Adicionar Teste</button>
            </div>
            <div class="year12-finals"></div>
        </div>

        <!-- Exams Tab -->
        <div id="exams-tab" class="tab-content" style="display: none;">
            <h2>Exames Nacionais</h2>
            <div>
                <select class="exam-subject"></select>
                <input type="number" placeholder="Nota (0-200)" onblur="addExamGrade(this)">
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Disciplina</th>
                        <th>Nota (0-200)</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody id="exam-summary-body"></tbody>
            </table>
        </div>

        <!-- Results Tab -->
        <div id="results-tab" class="tab-content" style="display: none;">
            <h2>Resultados</h2>
            <table class="finals-summary-table">
                <thead>
                    <tr>
                        <th>Disciplina</th>
                        <th>10º Ano</th>
                        <th>11º Ano</th>
                        <th>12º Ano</th>
                        <th>Nota Exame</th>
                        <th>CIF</th>
                        <th>Nota na Pauta</th>
                    </tr>
                </thead>
                <tbody id="summary-body"></tbody>
            </table>
            <div class="final-averages">
                <div>Média Anual</div>
                <div id="year10-average">-</div>
                <div id="year11-average">-</div>
                <div id="year12-average">-</div>
                <div id="total-average-no-exams">-</div>
                <div id="total-average-with-exams">-</div>
            </div>
            <div>
                <label>Peso dos Exames:</label>
                <input type="range" id="examWeight" min="0" max="100" value="50" oninput="updateWeights(this.value)">
                <span id="gradesWeight">50%</span>
            </div>
        </div>
    </div>

    <!-- Domain Info Popup -->
    <div id="domainInfoPopup" class="popup-overlay" style="display: none;">
        <div class="popup-content">
            <span class="close-popup" onclick="closePopup()">&times;</span>
            <img src="/notas/img/domains_info.png" alt="Informação sobre Domínios">
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js"></script>
    <script src="/notas/js/functions.js"></script>
</body>
</html>
